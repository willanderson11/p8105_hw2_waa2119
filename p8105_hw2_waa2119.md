p8105_hw2_waa2119
================
William Anderson
2022-09-30

``` r
library(tidyverse)
library(dplyr)
library(readxl)
```

# Homework 2

## Problem 1

First we will read in the data about entrance and exits for subway
stations in NYC

We will retain line, station, name, station latitude / longitude, routes
served, entry, vending, entrance type, and ADA compliance then convert
the entry variable from character to a logical variable

``` r
subway_data = 
  read_csv("HW2_Data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%

  janitor::clean_names() %>%
  
  select(line, station_name, station_latitude, station_longitude, route1:route11, entry, exit_only, vending, entrance_type, ada) %>%
  
  mutate(entry = recode(entry, "YES" = 1, "NO" = 0))
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
subway_data
```

    ## # A tibble: 1,868 × 20
    ##    line     station_…¹ stati…² stati…³ route1 route2 route3 route4 route5 route6
    ##    <chr>    <chr>        <dbl>   <dbl> <chr>  <chr>  <chr>  <chr>  <chr>  <chr> 
    ##  1 4 Avenue 25th St       40.7   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ##  2 4 Avenue 25th St       40.7   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ##  3 4 Avenue 36th St       40.7   -74.0 N      R      <NA>   <NA>   <NA>   <NA>  
    ##  4 4 Avenue 36th St       40.7   -74.0 N      R      <NA>   <NA>   <NA>   <NA>  
    ##  5 4 Avenue 36th St       40.7   -74.0 N      R      <NA>   <NA>   <NA>   <NA>  
    ##  6 4 Avenue 45th St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ##  7 4 Avenue 45th St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ##  8 4 Avenue 45th St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ##  9 4 Avenue 45th St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 10 4 Avenue 53rd St       40.6   -74.0 R      <NA>   <NA>   <NA>   <NA>   <NA>  
    ## # … with 1,858 more rows, 10 more variables: route7 <chr>, route8 <dbl>,
    ## #   route9 <dbl>, route10 <dbl>, route11 <dbl>, entry <dbl>, exit_only <chr>,
    ## #   vending <chr>, entrance_type <chr>, ada <lgl>, and abbreviated variable
    ## #   names ¹​station_name, ²​station_latitude, ³​station_longitude

This data contains information about the different subway lines in New
York City, the locations of their stations and the different routes they
operate on. This data set also has information on whether the entrance
types for the stations, whether the stations contain vendors and whether
they are compliant with the Americans with Disabilities Act.

-   The number of rows in this dataset are 1868 and the number of
    columns are 20

-   The number of distinct stations are 465

``` r
names_and_ada = distinct(subway_data, line, station_name, ada)

ADA_compliant = sum(names_and_ada$ada, na.rm = TRUE)
```

-   The number of ADA compliant stations is 84

-   The proportion of stations without vending that allow entrance is
    given below

``` r
subway_data %>%
  filter(vending != "YES") %>%
  pull(entry) %>%
mean
```

    ## [1] 0.3770492

Now we find the number of stations serving the A train and which of
these are ADA compliant.

``` r
route_number_and_name = distinct(subway_data, station_name, line, ada, across(contains("route")))

A_stations = filter(route_number_and_name, route1 == "A")

A_stations_with_ADA = filter(A_stations, ada == "TRUE")
```

-   The number of stations that serve the A train are 60

-   The number of stations that serve the A train and are ADA compliant
    are 17

## Problem 2

Now we will read in an excel file for Mr. Trash Wheel

``` r
mr_trash_wheel = 
  read_excel("HW2_Data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "Mr. Trash Wheel", skip = 1, na = "", range = cell_cols(1:14)) %>%
  janitor::clean_names() %>%
  na.omit() %>%
  mutate(sports_balls = as.integer(round(sports_balls))) %>%
  add_column()
```

Now we import the professor trash wheel dataset

``` r
prof_trash_wheel = 
  read_excel("HW2_Data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = "Professor Trash Wheel", skip = 1, na = "") %>%
  janitor::clean_names() %>%
  na.omit() %>%
  mutate(sports_balls = as.integer(round(sports_balls)))
```

Now we combine Mr. Trash Wheel and Professor Trash Wheel datasets

``` r
mr_trash_wheel$dumpster = as.double(mr_trash_wheel$dumpster)

trash_wheel_combined = 
  bind_rows(mr_trash_wheel, prof_trash_wheel, .id = "trash_wheel_type")


head(trash_wheel_combined, 15)
```

    ## # A tibble: 15 × 15
    ##    trash_wheel…¹ dumps…² month  year date                weigh…³ volum…⁴ plast…⁵
    ##    <chr>           <dbl> <chr> <dbl> <dttm>                <dbl>   <dbl>   <dbl>
    ##  1 1                   1 May    2014 2014-05-16 00:00:00    4.31      18    1450
    ##  2 1                   2 May    2014 2014-05-16 00:00:00    2.74      13    1120
    ##  3 1                   3 May    2014 2014-05-16 00:00:00    3.45      15    2450
    ##  4 1                   4 May    2014 2014-05-17 00:00:00    3.1       15    2380
    ##  5 1                   5 May    2014 2014-05-17 00:00:00    4.06      18     980
    ##  6 1                   6 May    2014 2014-05-20 00:00:00    2.71      13    1430
    ##  7 1                   7 May    2014 2014-05-21 00:00:00    1.91       8     910
    ##  8 1                   8 May    2014 2014-05-28 00:00:00    3.7       16    3580
    ##  9 1                   9 June   2014 2014-06-05 00:00:00    2.52      14    2400
    ## 10 1                  10 June   2014 2014-06-11 00:00:00    3.76      18    1340
    ## 11 1                  11 June   2014 2014-06-11 00:00:00    3.43      15     740
    ## 12 1                  12 June   2014 2014-06-12 00:00:00    4.17      19     950
    ## 13 1                  13 June   2014 2014-06-13 00:00:00    5.13      15     530
    ## 14 1                  14 June   2014 2014-06-13 00:00:00    4.17      15     840
    ## 15 1                  15 June   2014 2014-06-19 00:00:00    3.28      15    1130
    ## # … with 7 more variables: polystyrene <dbl>, cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, grocery_bags <dbl>, chip_bags <dbl>,
    ## #   sports_balls <int>, homes_powered <dbl>, and abbreviated variable names
    ## #   ¹​trash_wheel_type, ²​dumpster, ³​weight_tons, ⁴​volume_cubic_yards,
    ## #   ⁵​plastic_bottles

This combined data set contains dumpster data for two different
waterfront trash wheels in Baltimore, Maryland. They are operated by a
company called Healthy Harbor which aims to use these trash wheels to
clean and gather trash floating in the harbor in Baltimore. The combined
dumpsters data set contains 524 observations where trash_wheel_type = 1
is the Mr. Trash Wheel data set and trash_wheel_type = 2 is the
Professor Trash Wheel data set. Key variables are trash_wheel_type,
dumpster, month, year, date, weight_tons, volume_cubic_yards,
plastic_bottles, polystyrene, cigarette_butts, glass_bottles,
grocery_bags, chip_bags, sports_balls, homes_powered.

-   The total weight of trash collected by Professor Trash Wheel from
    2017 - 2020 was 135.5 tons.

-   The total number of sports balls collected by Mr. Trash Wheel in
    2020 was 856 balls.

## Problem 3

First we read in the pols-month data

``` r
polls_monthly = 
  read_csv("HW2_Data/pols-month.csv", na = "") %>%
  
  janitor::clean_names() %>%
  
  na.omit() %>%
  
  separate(mon, into = c("year", "month", "day")) %>%
  
  mutate(year = as.integer(year), month = as.integer(month), day = as.integer(day)) %>%
  
  mutate(month = month.name[month]) %>%
  
  mutate(president = ifelse(prez_gop == 0, "dem", "gop")) %>%
  
  select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(polls_monthly, 20)
```

    ## # A tibble: 20 × 9
    ##     year month     gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <int> <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 January        23      51     253      23      45     198 dem      
    ##  2  1947 February       23      51     253      23      45     198 dem      
    ##  3  1947 March          23      51     253      23      45     198 dem      
    ##  4  1947 April          23      51     253      23      45     198 dem      
    ##  5  1947 May            23      51     253      23      45     198 dem      
    ##  6  1947 June           23      51     253      23      45     198 dem      
    ##  7  1947 July           23      51     253      23      45     198 dem      
    ##  8  1947 August         23      51     253      23      45     198 dem      
    ##  9  1947 September      23      51     253      23      45     198 dem      
    ## 10  1947 October        23      51     253      23      45     198 dem      
    ## 11  1947 November       24      51     253      23      45     198 dem      
    ## 12  1947 December       24      51     253      23      45     198 dem      
    ## 13  1948 January        22      53     253      24      48     198 dem      
    ## 14  1948 February       22      53     253      24      48     198 dem      
    ## 15  1948 March          22      53     253      24      48     198 dem      
    ## 16  1948 April          22      53     253      24      48     198 dem      
    ## 17  1948 May            22      53     253      24      48     198 dem      
    ## 18  1948 June           22      53     253      24      48     198 dem      
    ## 19  1948 July           22      53     253      24      48     198 dem      
    ## 20  1948 August         22      53     253      24      48     198 dem

Next we read in the snp stock data

``` r
snp_stock_data = 
  read_csv("HW2_Data/snp.csv", na = "") %>%
  
  janitor::clean_names() %>%
  
  na.omit() %>%
  
  separate(date, into = c("month", "day", "year")) %>%
  
  mutate(year = as.integer(year), month = as.integer(month), day = as.integer(day)) %>%
  
  mutate(year_change = ifelse(year < 22, 2000, 1900)) %>%
  
  mutate(year = year_change + year) %>%
  
  mutate(month = month.name[month]) %>%

  select(-day, -year_change) %>%
  
  relocate(year, .before = month)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(snp_stock_data, 20)
```

    ## # A tibble: 20 × 3
    ##     year month     close
    ##    <dbl> <chr>     <dbl>
    ##  1  2015 July      2080.
    ##  2  2015 June      2063.
    ##  3  2015 May       2107.
    ##  4  2015 April     2086.
    ##  5  2015 March     2068.
    ##  6  2015 February  2104.
    ##  7  2015 January   1995.
    ##  8  2014 December  2059.
    ##  9  2014 November  2068.
    ## 10  2014 October   2018.
    ## 11  2014 September 1972.
    ## 12  2014 August    2003.
    ## 13  2014 July      1931.
    ## 14  2014 June      1960.
    ## 15  2014 May       1924.
    ## 16  2014 April     1884.
    ## 17  2014 March     1872.
    ## 18  2014 February  1859.
    ## 19  2014 January   1783.
    ## 20  2013 December  1848.

Now we will import the unemployment data

``` r
unemployment = 
  read_csv("HW2_Data/unemployment.csv", na = "") %>%
  
  janitor::clean_names() %>%
  
  na.omit() %>%
  
  pivot_longer(
    jan:dec, names_to = "month", values_to = "unemployment %") %>%
  
  mutate(year = as.integer(year))
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(unemployment, 20)
```

    ## # A tibble: 20 × 3
    ##     year month `unemployment %`
    ##    <int> <chr>            <dbl>
    ##  1  1948 jan                3.4
    ##  2  1948 feb                3.8
    ##  3  1948 mar                4  
    ##  4  1948 apr                3.9
    ##  5  1948 may                3.5
    ##  6  1948 jun                3.6
    ##  7  1948 jul                3.6
    ##  8  1948 aug                3.9
    ##  9  1948 sep                3.8
    ## 10  1948 oct                3.7
    ## 11  1948 nov                3.8
    ## 12  1948 dec                4  
    ## 13  1949 jan                4.3
    ## 14  1949 feb                4.7
    ## 15  1949 mar                5  
    ## 16  1949 apr                5.3
    ## 17  1949 may                6.1
    ## 18  1949 jun                6.2
    ## 19  1949 jul                6.7
    ## 20  1949 aug                6.8
